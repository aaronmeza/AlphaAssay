apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: trading

resources:
  - dxfeed-adapter/
  - ib-bridge/
  - backtrader/
  - order-manager/
  - rl-service/
  - streamlit-ui/

# Apply to every Deployment rendered by this kustomization
patches:
  - target:
      group: apps
      version: v1
      kind: Deployment
    patch: |-
      - op: add
        path: /spec/template/spec/tolerations
        value:
          - key: "node-role.kubernetes.io/control-plane"
            operator: "Exists"
            effect: "NoSchedule"
          - key: "node-role.kubernetes.io/master"
            operator: "Exists"
            effect: "NoSchedule"
